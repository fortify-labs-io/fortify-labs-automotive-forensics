# GPS Data Extractor for pas_debug.log Files

A Python utility for extracting Map Matched (MM) GPS coordinates from Ford SYNC 3 `pas_debug.log` diagnostic files generated by the NAV_FRAMEWORK_IF component.

## Overview

This script processes multiple `pas_debug.log*` files from Ford SYNC 3 infotainment systems, extracts GPS position data from navigation framework logs, and outputs clean, structured coordinate data suitable for further analysis or visualization.

## Features

- **Batch Processing**: Automatically discovers and processes all `pas_debug.log*` files in a directory
- **File Validation**: Verifies expected file count (26 files) before processing
- **Selective Extraction**: Extracts only Map Matched (MM) GPS data, ignoring Dead Reckoning (DR) positions
- **Error Resilient**: Continues processing even if individual files encounter read errors
- **Structured Output**: Generates pipe-separated output with clear headers for easy parsing

## Requirements

- Python 3.6 or higher
- No external dependencies (uses standard library only)

## Installation

1. Download the script:

2. Make it executable:
```bash
chmod +x extract-GPS_pas-debug-files.py
```

## Usage

### Basic Usage

Place the script in the same directory as your `pas_debug.log*` files and run:

```bash
python3 extract-GPS_pas-debug-files.py
```

Or if made executable:

```bash
./extract-GPS_pas-debug-files.py
```

### Expected Input Files

The script searches for files matching the pattern `pas_debug.log*` and expects to find 26 files. If a different number is found, you'll receive a warning prompt:

```
Found 24 file(s) matching 'pas_debug.log*'

WARNING: Expected 26 files but found 24
Continue anyway? (y/n):
```

## Input Format

The script parses log lines with the following structure:

```
DD/MM/YYYY HH:MM:SS.mmm/thread/priority/NAV_FRAMEWORK_IF/SendGPSCanData/line/=[DR Output: <SD2>...</SD2>], [signal_type:X SatInView:YY], [MM Output: <SD2>Lon:XXX Lat:YYY Alt:ZZZ Hd:HHH</SD2>]
```

### Extracted Data

From the above line, the script extracts:
- **Timestamp**
- **Longitude**
- **Latitude**
- **Altitude**
- **Heading**

## Output Format

### Output File

The script generates `extracted_detailed_GPS_pas-debug.log` with the following structure:

```
# Extracted GPS Data from pas_debug.log files
# Format: Timestamp | Longitude | Latitude | Altitude | Heading
#================================================================================

<timestamp> | Lon:xxxxxxxx.xxxxxx | Lat:-xxxxxxxx.xxxxxx | Alt:xxx.xxxxxx | Hd:xxx.xxxxxx

...
```

### Coordinate Format

**Important**: The GPS coordinates are in a scaled integer format commonly used in automotive systems:

- **Longitude**: Value × 10⁻⁷ to convert to decimal degrees
  - Example: `15128264.500000` → `151.282645°E` (Sydney Opera House)
- **Latitude**: Value × 10⁻⁷ to convert to decimal degrees
  - Example: `-3385792.000000` → `-33.85792°S` (Sydney Opera House)

### Converting to Standard Decimal Degrees

To convert the extracted coordinates to standard decimal degrees:

```python
longitude_degrees = float(longitude) / 10000000
latitude_degrees = float(latitude) / 10000000
```

Example conversion:
```python
# From extracted data (example: Sydney Opera House)
lon = 15128264.500000
lat = -3385792.000000

# Convert to decimal degrees
lon_dd = lon / 10000000  # = 151.282645°E
lat_dd = lat / 10000000  # = -33.85792°S
```

## Example Output

### Console Output

```
================================================================================
GPS Data Extractor for pas_debug.log files
================================================================================

Found 26 file(s) matching 'pas_debug.log*'
✓ All 26 expected files found

Processing 26 files...
  Reading: pas_debug.log.1
  Reading: pas_debug.log.2
  Reading: pas_debug.log.3
  ...
  Reading: pas_debug.log.26

Writing 15847 GPS records to extracted_detailed_GPS_pas-debug.log...

================================================================================
Extraction complete!
  Files processed: 26
  GPS records extracted: 15847
  Output file: extracted_detailed_GPS_pas-debug.log
================================================================================
```

## Data Processing Tips

### Parsing the Output File

```python
import re

with open('extracted_detailed_GPS_pas-debug.log', 'r') as f:
    for line in f:
        if line.startswith('#'):
            continue  # Skip header lines
        
        # Parse pipe-separated values
        match = re.search(r'(\d{2}/\d{2}/\d{4}\s+\d{2}:\d{2}:\d{2}\.\d{3})\s+\|\s+Lon:([-\d.]+)\s+\|\s+Lat:([-\d.]+)\s+\|\s+Alt:([-\d.]+)\s+\|\s+Hd:([-\d.]+)', line)
        if match:
            timestamp = match.group(1)
            lon = float(match.group(2)) / 10000000
            lat = float(match.group(3)) / 10000000
            alt = float(match.group(4))
            heading = float(match.group(5))
            
            print(f"{timestamp}: {lat:.6f}°, {lon:.6f}°")
```

### Generating KML for Google Earth

```python
import simplekml

kml = simplekml.Kml()

with open('extracted_detailed_GPS_pas-debug.log', 'r') as f:
    for line in f:
        if line.startswith('#'):
            continue
        
        # Parse and convert coordinates
        match = re.search(r'Lon:([-\d.]+)\s+\|\s+Lat:([-\d.]+)', line)
        if match:
            lon = float(match.group(1)) / 10000000
            lat = float(match.group(2)) / 10000000
            
            kml.newpoint(coords=[(lon, lat)])

kml.save('gps_track.kml')
```

## Privacy & Security

**Warning**: GPS data reveals location history and travel patterns. Handle extracted data appropriately:

- Redact or anonymize data before sharing publicly
- Be aware of privacy implications when processing personal vehicle data
- Comply with applicable data protection regulations

## License

This script is provided as-is for automotive forensics and security research purposes.

## Author

Created by Fortify Labs for automotive cybersecurity research and forensic analysis.

---

**For more information about Ford SYNC forensics and automotive cybersecurity research, visit the Fortify Labs blog.**
